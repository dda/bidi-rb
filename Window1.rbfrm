#tag WindowBegin Window Window1   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   455   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   1992943246   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   "BiDi tests"   Visible         =   True   Width           =   698   Begin TextArea ef1      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   176      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   286      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   ""      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   46      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   392   End   Begin ListBox lb1      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   2      ColumnsResizable=   ""      ColumnWidths    =   "100%"      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   389      HelpTag         =   ""      Hierarchical    =   True      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   14      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   254      _ScrollOffset   =   0      _ScrollWidth    =   -1   End   Begin PopupMenu pm1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "El Al (Hebrew: אל על‎, skyward) (TASE: ELAL) is the national airline of Israel.\rJamel Debbouze (Arabic: جمال دبّوز‎) (born June 18, 1975 in Paris) is a French actor, comedian and producer of Moroccan descent.\r""روسيا تواصل امداد أوروبا بالغاز بالرغم من خلافها مع أوكرانيا""\rעב""ל 456/07 - דליה בן ישי נ' המוסד לביטוח לאומי\rLongerSample"      Italic          =   ""      Left            =   286      ListIndex       =   -1      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   14      Underline       =   ""      Visible         =   True      Width           =   392   End   Begin PushButton pbTest      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "test"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   415      Underline       =   ""      Visible         =   True      Width           =   57   End   Begin Canvas cv1      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   195      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   286      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Top             =   240      UseFocusRing    =   True      Visible         =   True      Width           =   392   End   Begin PushButton pbTestDigits      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "digits"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   89      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   415      Underline       =   ""      Visible         =   True      Width           =   60   End   Begin PushButton pbTestDiacritics      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "'critics"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   161      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   415      Underline       =   ""      Visible         =   True      Width           =   60   End   Begin PushButton pbClear      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "X"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   233      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   415      Underline       =   ""      Visible         =   True      Width           =   41   End   Begin Label StaticText1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   34      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   711      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   8      TabPanelIndex   =   0      Text            =   "Select a text from the popup here, then click test"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   0      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   216   End   Begin Label StaticText2      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   36      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   66      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   9      TabPanelIndex   =   0      Text            =   "digits tests different kinds of numbers"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   461      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   118   End   Begin Label StaticText3      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   42      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   209      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   10      TabPanelIndex   =   0      Text            =   "'critics tests different kind of diacritics."      TextAlign       =   0      TextColor       =   0      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   469      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   135   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  // ParseDiacritics()		  BuildDiacriticsDB()		  		  TestDigits()		  TestDiacritics()		End Sub	#tag EndEvent	#tag Event		Sub Resized()		  if myText<>"" Then		    lb1.DeleteAllRows()		    Dim w,h As Integer		    w=cv1.Width		    h=cv1.Height		    cvPic=New Picture(w, h, 32)		    Dim g As Graphics=cvPic.Graphics		    		    g.DrawStringBiDi(myText, lb1)		    		    cv1.Refresh()		  End If		  		  		End Sub	#tag EndEvent	#tag Event		Sub Resizing()		  if myText<>"" Then		    lb1.DeleteAllRows()		    Dim w,h As Integer		    w=cv1.Width		    h=cv1.Height		    cvPic=New Picture(w, h, 32)		    Dim g As Graphics=cvPic.Graphics		    		    g.DrawStringBiDi(myText, lb1)		    		    cv1.Refresh()		  End If		  		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub TestDiacritics()		  		  lb1.AddRow "！="+GetEquivalent("！")		  		  Dim s As String="！＂＃＄％＆＇（）［＼］｝｜｛｜¡¿"		  lb1.AddRow s		  lb1.AddRow " can be retrofitted to:"		  lb1.AddRow NormalizeDiacritics(s)		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub TestDigits()		  Dim s As String		  Dim i,j As Integer		  Dim digits(-1) As String		  		  s=ef1.Text.Trim()		  if s="" Then		    digits.Append "፫"		    digits.Append "∃"		    digits.Append "᭑"		    digits.Append "๒"		    digits.Append "༤"		    digits.Append "၁"		    digits.Append "Ⅶ"		    digits.Append "零"		    digits.Append "一"		    digits.Append "二"		    digits.Append "參"		    digits.Append "肆"		    digits.Append "伍"		    digits.Append "六"		    digits.Append "七"		    digits.Append "八"		    digits.Append "九"		    digits.Append "什"		  Else		    j=s.Len()		    For i=1 to j		      digits.Append s.Mid(i,1)		    Next		  End If		  		  j=digits.Ubound()		  For i=0 to j		    s=digits(i)		    lb1.AddRow "Testing whether "+s+" ["+HexMin(Asc(ConvertEncoding(s, Encodings.UTF16)), 4)+"] is a digit."		    Dim n As Integer=IsDigit(s)		    if n=-1 Then		      lb1.AddRow " → No"		    Else		      lb1.AddRow " Yes: "+Str(n)+" in "+ScriptName(s)+" ["+HexMin(Asc(s),4)+"]"		    End If		  Next		  		  		End Sub	#tag EndMethod	#tag Property, Flags = &h0		cvPic As Picture	#tag EndProperty	#tag Property, Flags = &h0		myText As String	#tag EndProperty#tag EndWindowCode#tag Events lb1	#tag Event		Sub ExpandRow(row As Integer)		  Dim i,j As Integer		  Dim t(-1) As String=lb1.Cell(row,1).SplitB(ChrB(9))		  		  j=t.Ubound()		  For i=0 to j		    me.InsertRow i+row+1, t(i)		  Next		  		  		End Sub	#tag EndEvent	#tag Event		Sub CollapseRow(row As Integer)		  Dim i,j As Integer		  Dim t(-1) As String=lb1.Cell(row,1).SplitB(ChrB(9))		  		  j=t.Ubound()		  For i=0 to j		    me.RemoveRow row+1		  Next		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pm1	#tag Event		Sub Change()		  Dim i As Integer=me.ListIndex		  		  if i=-1 Then Return		  		  Dim s As String=pm1.List(i)		  if s="LongerSample" Then s=LongerSample		  ef1.Text=s		  pm1.ListIndex=-1		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbTest	#tag Event		Sub Action()		  Dim w,h As Integer		  w=cv1.Width		  h=cv1.Height		  cvPic=New Picture(w, h, 32)		  Dim g As Graphics=cvPic.Graphics		  		  myText=ef1.Text		  g.TextFont=ef1.TextFont		  g.TextSize=ef1.TextSize		  		  g.DrawStringBiDi(myText, lb1)		  		  cv1.Refresh()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events cv1	#tag Event		Sub Paint(g As Graphics)		  if cvPic=Nil Then Return		  		  g.DrawPicture cvPic,0,0		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbTestDigits	#tag Event		Sub Action()		  TestDigits()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbTestDiacritics	#tag Event		Sub Action()		  TestDiacritics()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbClear	#tag Event		Sub Action()		  lb1.DeleteAllRows()		  		  		End Sub	#tag EndEvent#tag EndEvents